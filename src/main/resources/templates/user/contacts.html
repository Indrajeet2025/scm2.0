<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{base :: parent(~{::#content}, ~{::title}, ~{::script})}">

<head>
    <title>View Contacts</title>
</head>

<body>

<div id="content">

    <!-- Sidebar -->
    <div th:if="${loggedInUser}">
        <div th:replace="~{user/sidebar :: sidebar}"></div>
    </div>

    <!-- Main Profile Content Container -->
    <div class="min-h-screen justify-start rounded-xl bg-white dark:bg-gray-800">

        <div class="mb-10 text-center">
            <h1 class="text-5xl font-semibold mt-10 dark:text-white">
                Welcome to Contacts page!
            </h1>
            <p class="mt-2 dark:text-gray-300">
                Access your all contacts here......
            </p>
        </div>

        <div class="contacts_container border p-5">

            <div class="relative overflow-x-auto bg-neutral-primary-soft shadow-xs rounded-base border border-default">

                <!-- Search Section -->
                <form th:action="@{'/user/contacts/search'}">
                    <div class="flex p-5 items-center justify-start flex-column flex-wrap md:flex-row space-y-4 md:space-y-0">

                        <div class="relative w-full md:w-auto">
                            <select
                                    name="field"
                                    id="field_select"
                                    class="block w-full appearance-none px-4 pr-10 py-2.5 text-sm
                   bg-white dark:bg-gray-800 text-body
                   border border-default-medium rounded-lg
                   focus:border-brand focus:ring-1 focus:ring-brand
                   cursor-pointer">
                                <option value="" selected>Select Field</option>
                                <option value="name">Name</option>
                                <option value="phone">Phone</option>
                                <option value="email">Email</option>
                            </select>
                        </div>

                        <!-- Search Input + Button -->
                        <div class="flex items-center gap-3 p-4">

                            <!-- Search Input -->
                            <div class="relative">
                                <label for="input-group-1" class="sr-only">Search</label>

                                <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                                    <svg class="w-4 h-4 text-body" aria-hidden="true"
                                         xmlns="http://www.w3.org/2000/svg"
                                         width="24" height="24" fill="none" viewBox="0 0 24 24">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                              d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/>
                                    </svg>
                                </div>

                                <input name="keyword"
                                       type="text"
                                       id="input-group-1"
                                       class="block w-full max-w-96 ps-9 pe-3 py-2
                                              bg-neutral-secondary-medium
                                              border border-default-medium
                                              text-heading text-sm rounded-base
                                              focus:ring-brand focus:border-brand
                                              shadow-xs placeholder:text-body"
                                       placeholder="Search">
                            </div>

                            <button type="submit"
                                    class="px-4 py-2 bg-gray-800 text-white rounded">
                                Search
                            </button>

                        </div>

                    </div>
                </form>

                <!-- Contacts Table -->
                <table class="w-full text-sm text-left rtl:text-right text-body">
                    <thead class="text-sm text-body bg-neutral-secondary-medium border-b border-t border-default-medium">
                    <tr>
                        <th class="px-6 py-3 font-medium">Name</th>
                        <th class="px-6 py-3 font-medium">Phone</th>
                        <th class="px-6 py-3 font-medium">Links</th>
                        <th class="px-6 py-3 font-medium">Action</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="c : ${pageContact.content}"
                        th:object="${c}"
                        class="bg-neutral-primary-soft border-b border-default hover:bg-neutral-secondary-medium">

                        <!-- Name + Email -->
                        <td class="px-6 py-4 flex items-center text-heading whitespace-nowrap">
                            <img th:onerror="this.src='/images/defaultProfile.jpg'"
                                 th:src="@{*{picture}}"
                                 class="w-10 h-10 rounded-full"
                                 alt="Profile">
                            <div class="ps-3">
                                <div class="text-base font-semibold" th:text="*{name}">Neil Sims</div>
                                <div class="font-normal text-body" th:text="*{email}"></div>
                            </div>
                        </td>

                        <!-- Phone -->
                        <td class="px-6 py-4">
                            <i class="fa-solid fa-phone w-4 h-4"></i>
                            <span th:text="*{phoneNumber}"></span>
                        </td>

                        <!-- Social Links -->
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="h-2.5 w-2.5 rounded-full bg-success me-2"></div>
                                <a th:href="@{*{facebookLink}}"><i class="fa-brands fa-facebook w-6 h-6"></i></a>
                                <a th:href="@{*{linkedInLink}}"><i class="fa-brands fa-linkedin w-6 h-6"></i></a>
                            </div>
                        </td>

                        <!-- Action Buttons -->
                        <td class="px-6 py-4">
                            <div class="flex items-center gap-2">

                                <!-- â­ Favourite -->
                                <button type="button"
                                        th:onclick="|toggleFavorite('__${c.id}__', this)|">
                                    <i class="fa-star"
                                       th:classappend="*{favorite} ? ' fa-solid text-yellow-400' : ' fa-regular text-gray-400'">
                                    </i>
                                </button>

                                <!-- Delete -->
                                <button th:onclick="deleteContactData([[${c.id}]])">
                                    <i class="fa-solid w-5 h-5 fa-trash"></i>
                                </button>

                                <!-- Edit -->
                                <a th:href="@{'/user/contacts/view/'+*{id}}">
                                    <i class="fa-solid w-5 h-5 fa-pen"></i>
                                </a>

                                <!-- View -->
                                <button type="button" class="p-1"
                                        th:onclick="|loadContactData('__${c.id}__')|">
                                    <i class="fa-solid w-5 h-5 fa-eye"></i>
                                </button>

                            </div>
                        </td>

                    </tr>
                    </tbody>
                </table>

                <!-- Pagination -->
                <div class="pagination-container p-5 text-center">
                    <nav>
                        <ul class="flex justify-center -space-x-px text-sm">

                            <li th:unless="${pageContact.first}">
                                <a th:href="@{/user/contacts/view(size=${pageSize},page=${pageContact.number-1})}"
                                   class="flex items-center justify-center border px-3 h-10 rounded-s-base bg-neutral-secondary-medium hover:bg-neutral-tertiary-medium">
                                    Previous
                                </a>
                            </li>

                            <li th:each="index : ${#numbers.sequence(0, pageContact.totalPages-1)}">
                                <a th:href="@{'/user/contacts/view?size='+${pageSize}+'&page='+${index+1}}"
                                   th:classappend="${index==pageContact.number?'bg-blue-100 dark:bg-gray-700':'bg-white dark:bg-gray-700'}"
                                   class="flex items-center justify-center border w-10 h-10">
                                    <span th:text="${index + 1}"></span>
                                </a>
                            </li>

                            <li th:unless="${pageContact.last}">
                                <a th:href="@{/user/contacts/view(size=${pageSize},page=${pageContact.number+1})}"
                                   class="flex items-center justify-center border px-3 h-10 rounded-e-base bg-neutral-secondary-medium hover:bg-neutral-tertiary-medium">
                                    Next
                                </a>
                            </li>

                        </ul>
                    </nav>
                </div>

            </div>

        </div>

    </div>

    <!-- Contact Modal -->
    <div th:replace="~{user/contact_modal :: contact}"></div>

</div>

<!-- JS Files -->
<script th:src="@{'/js/contact.js'}"></script>

</body>
</html>
